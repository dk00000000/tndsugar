[Q001]

GET_USER="SELECT USER_CODE,USER_NAME FROM NIS.USERMAST  WHERE USER_CODE=':PUSER_CODE'"

 GET_FARMER="SELECT SR.SR_MNAME,TXN_SEQ FIELD_SR,MM.TXN_SRNO SRNO,MM.TXN_FORMNO FORM_NUMBER,MM.TXN_REF2 SURVEY_NUMBER,ISM.IS_MNAME IRRIGATION,IM.IM_MNAME IM_NAME
,CT.CT_MNAME CT_NAME,CV.CV_NAME,TO_CHAR(MM.TXN_DATE1,'DD/MM/YYYY')PLANT_DATE,
TO_CHAR(MM.TXN_CAREA,'9990.00') REGISTERED_AREA
FROM NIS.MMMMAST MM, NIS.PRTMAST PM, NIS.BRANCHMAST BN, NIS.VLGMAST B, NIS.PLOCMAST PL, NIS.DIVMAST DV, NIS.SSEGMAST SS
,NIS.SVRMAST SR ,NIS.IRRSRCMAST ISM, NIS.IRRMTDMAST IM,NIS.CANETMAST CT,NIS.CANEVMAST CV
WHERE MM.TXN_ACCD = PM.PRT_CODE
AND MM.COMP_CODE = PM.COMP_CODE 
AND MM.TXN_BNKBR =  BN.BR_CODE(+)
AND MM.TXN_SHIVAR = SR.SR_CODE(+)
AND PM.COMP_CODE = B.COMP_CODE(+)
AND PM.PRT_VILLEGE = B.VL_CODE(+)
AND MM.TXN_IRRSRC = ISM.IS_CODE
AND MM.TXN_IRRMTD = IM.IM_CODE
AND MM.TXN_CTYPE = CT.CT_CODE
AND MM.TXN_CVAR = CV.CV_CODE
AND MM.COMP_CODE = PL.COMP_CODE
AND MM.PLOC_CODE = PL.PLOC_CODE
AND MM.COMP_CODE = DV.COMP_CODE(+)
AND MM.TXN_DIVN =  DV.DIV_CODE(+)
AND MM.COMP_CODE = SS.COMP_CODE
AND MM.SSEG_CODE = SS.SSEG_CODE 
AND TXN_SEASON=':PTXN_SEASON'
AND TXN_ACCD=':PPRT_CODE'";


GET_FARMERBILL="SELECT BT_MNAME,FORTNIGHT,SEASON_START_DT ,SEASON_END_DT,  RATE, BILL_NO, TONNAGE, TXD_AMT,  DEDUCTION, NETT_AMT, BANK_BRANCH_NAME, TXN_PRTACNO
FROM (
SELECT TXN_SEQ,TXD_RUNO,TXN_DDNO SEASON, TXN_RFNO FORTNIGHT,SND_FRDT SEASON_START_DT ,SND_TODT SEASON_END_DT, BT_CODE, BT_NAME,
BT_MNAME,TXN_ITCHLNO SHIVAR,SR_NAME SHIVAR_NAME,SR_MNAME,
VL_CODE VILLAGE_CODE, VL_NAME VILLAGE_NAME, VL_MNAME,SC_CODE SECTION_CODE, SC_NAME SECTION_NAME, SC_MNAME ,
TXN_SLCD FARMER,PRT_NAME, PRT_MNAME,TXN_SRNO BILL_NO,TO_NUMBER(TXN_PBLNO) RATE, TXN_PARADV TONNAGE, TXN_BAMT DEDUCTION, TXN_AMT NETT_AMT, TXD_ACCD,AC_DESC,TXD_SLCD,
AD_CODE DED_CODE, AD_NAME || DECODE(TXD_SLCD,NULL,NULL,DECODE(TXN_SLCD,TXD_SLCD,NULL,' AS GURANTER FOR PARTY :'||TXD_SLCD||':'||NIS.F_REP_FINDPRTNAME(TXD_SLCD,B.COMP_CODE))) DED_NAME, AD_MNAME,
TXN_PRTACNO ,
DECODE(TXD_RUNO,1,TXN_PRTBRANCH,B.TXD_BLNO) PRT_BANKBR,
(SELECT BR_SNAME FROM NIS.BRANCHMAST K WHERE K.COMP_CODE=  J.COMP_CODE AND BR_CODE = PRT_BANKBR ) BANK_BRANCH_NAME,
TXD_AMT,TXD_CRDR,TXD_RFNO,TXD_BLNO ,DRAWN_ON,TXD_NARR,
(SELECT SY_NAME FROM SOCMAST WHERE COMP_CODE = J.COMP_CODE AND SY_CODE = B.DRAWN_ON ) SOC_NAME,
(SELECT BR_SNAME FROM NIS.BRANCHMAST K WHERE K.COMP_CODE=  J.COMP_CODE AND BR_CODE = B.TXD_BLNO ) BRANCH_NAME,
NIS.F_GET_PRTYNAME (B.COMP_CODE,B.TXD_SLCD,'P#M') DED_FOR,
A.TXN_CHNO SLIPS
FROM NIS.FAMAST A, NIS.FADMAST B, NIS.ACMAST C, NIS.SSNDMAST D, NIS.BLTMAST E , NIS.SVRMAST F, NIS.VLGMAST G, NIS.SECMAST H, NIS.ADMAST I, NIS.PRTMAST J
WHERE TXD_SEQ =TXN_SEQ
AND C.COMP_CODE=B.COMP_CODE
AND D.COMP_CODE= A.COMP_CODE
AND D.SND_CODE = A.TXN_DDNO
AND D.SND_FNNO = A.TXN_RFNO
AND TXD_ACCD=AC_CODE
AND E.COMP_CODE=A.COMP_CODE
AND E.BT_CODE = A.TXN_ISSUSER
AND TXN_DOC='CPV'
AND EXISTS (SELECT 1 FROM NIS.SSEGMAST K WHERE K.COMP_CODE=A.COMP_CODE AND K.SSEG_CODE=A.SSEG_CODE AND K.SSEG_DTYPE = 'CPVF' )
AND A.COMP_CODE = 'DS'
AND D.SND_CODE = ':PTXN_SEASON'
AND INSTR(A.POSTED_BY ,'---') = 0
AND TXD_RUNO <> 0
AND F.COMP_CODE = A.COMP_CODE
AND F.SR_CODE = A.TXN_ITCHLNO
AND G.COMP_CODE = F.COMP_CODE
AND G.VL_CODE = F.SR_VILLAGE
AND H.COMP_CODE = G.COMP_CODE
AND H.SC_CODE = G.VL_SECTION
AND I.COMP_CODE (+) = B.COMP_CODE
AND I.AD_CODE (+) = B.TXD_CPP
AND J.COMP_CODE = A.COMP_CODE
AND J.PRT_CODE = A.TXN_SLCD
AND A.TXN_SLCD = ':PPRT_CODE'
ORDER BY TXN_SRNO )";


GET_WSINFO="SELECT COUNT(*) SLIPS, SUM((NVL(WS.TXN_BILLWT,0))) TOTAL_RECEIVED_WT, 
SUM(DECODE(WS.TXN_CANEQ, 'CQ001', NVL(WS.TXN_BILLWT,0), 0)) RECD_CQ001,
SUM(DECODE(WS.TXN_CANEQ, 'CQ002', NVL(WS.TXN_BILLWT,0), 0))  RECD_CQ002,
SUM(DECODE(WS.TXN_CANEQ, 'CQ003', NVL(WS.TXN_BILLWT,0), 0))  RECD_CQ003
 FROM NIS.MMMMAST WS WHERE TXN_DOC='WS' AND TXN_ACCD=':PPRT_CODE'  AND TXN_BILLWT IS NOT NULL AND TXN_SEASON=':PTXN_SEASON'"

GET_CONTRACTOR="SELECT TXN_SRNO SequenceNo, TXN_ACCD ||' - '|| NIS.F_REP_FINDPRTNAME(TXN_ACCD, COMP_CODE) CONTRACTORNAME, TXN_ACCD CONTRACTORCODE, 
(SELECT VT_NAME FROM NIS.VHLTMAST WHERE COMP_CODE = M.COMP_CODE AND VT_CODE = TXN_VTYPE) VEHICLETYPE, 
TXN_VHNO VHNO,
to_char(MODIFIED_DT,'DD/MM/YYYY HH24:MI:SS') MODIFIEDDATETIME,TXN_VHNO,
ltrim(rtrim(NIS.F_REP_FINDPRTNAME(TXN_ACCD, COMP_CODE))) ||'-'|| TXN_ACCD || '-' || TXN_SRNO || '-' || (SELECT VT_NAME FROM NIS.VHLTMAST WHERE COMP_CODE = M.COMP_CODE AND VT_CODE = TXN_VTYPE) || decode(txn_vhno, null, null, '-') || TXN_VHNO COMBFIELD 
FROM NIS.MMMMAST M
WHERE TXN_DOC = 'CET'
AND TXN_STAT='O'
AND TXN_SEASON = '2017-18' "


GET_DETAILS="SELECT TXN_SRNO SEQUENCENO, NIS.F_REP_FINDPRTNAME(TXN_ACCD, COMP_CODE) ||' - '|| TXN_ACCD CONTRACTORNAME, TXN_ACCD CONTRACTORCODE, 
RTRIM(LTRIM(NIS.F_REP_FINDPRTNAME(TXN_CONS, COMP_CODE) || ' - ' || TXN_CONS)) SCONTRACTOR, TXN_CONS SCONTRACTOR_CODE,
RTRIM(LTRIM(NIS.F_REP_FINDPRTNAME(TXN_GRNT1, COMP_CODE) || ' - ' || TXN_GRNT1)) FGUARANTER,TXN_GRNT1 FGUARANTER_CODE,
RTRIM(LTRIM(NIS.F_REP_FINDPRTNAME(TXN_GRNT2, COMP_CODE) || ' - ' || TXN_GRNT2)) SGUARANTER,TXN_GRNT2 SGUARANTER_CODE,
RTRIM(LTRIM(NIS.F_REP_FINDPRTNAME(TXN_GRNT3, COMP_CODE) || DECODE(TXN_GRNT3, NULL, NULL, ' - ') || TXN_GRNT3)) TGUARANTER,TXN_GRNT3 TGUARANTER_CODE,
(SELECT VT_NAME FROM NIS.VHLTMAST WHERE COMP_CODE = M.COMP_CODE AND VT_CODE = TXN_VTYPE) VEHICLETYPE, 
TXN_VHNO VHNO,
TXN_SRNO ||'/' ||'M' ||'PHOTO.JPG' PHOTOM, TXN_SRNO ||'/' ||'M' ||'FINGERPRINT.JPG' FINGERPRINTM,
TXN_SRNO ||'/' ||'B' ||'PHOTO.JPG' PHOTOB, TXN_SRNO ||'/' ||'B' ||'FINGERPRINT.JPG' FINGERPRINTB,
TXN_SRNO ||'/' ||'F' ||'PHOTO.JPG' PHOTOF, TXN_SRNO ||'/' ||'F' ||'FINGERPRINT.JPG' FINGERPRINTF,
TXN_SRNO ||'/' ||'S' ||'PHOTO.JPG' PHOTOS, TXN_SRNO ||'/' ||'S' ||'FINGERPRINT.JPG' FINGERPRINTS,
TXN_SRNO ||'/' ||'T' ||'PHOTO.JPG' PHOTOT, TXN_SRNO ||'/' ||'T' ||'FINGERPRINT.JPG' FINGERPRINTT,
TO_CHAR(MODIFIED_DT,'DD/MM/YYYY HH24:MI:SS') MODIFIEDDATETIME,TXN_VHNO,
LTRIM(RTRIM(NIS.F_REP_FINDPRTNAME(TXN_ACCD, COMP_CODE))) ||'-'|| TXN_ACCD || '-' || TXN_SRNO || '-' || (SELECT VT_NAME FROM NIS.VHLTMAST WHERE COMP_CODE = M.COMP_CODE AND VT_CODE = TXN_VTYPE) || DECODE(TXN_VHNO, NULL, NULL, '-') || TXN_VHNO COMBFIELD 
FROM NIS.MMMMAST M
WHERE TXN_DOC = 'CET' AND TXN_SRNO =':PTXN_SRNO'
AND TXN_SEASON = '2017-18'"