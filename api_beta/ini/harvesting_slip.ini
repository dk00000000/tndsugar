
SECTION_QRY="SELECT SC_CODE,SC_NAME,SC_DIVISION,CREATED_DT,MODIFIED_DT FROM NIS.SECMAST ORDER BY SECMAST.SC_CODE ASC"

VLGMAST_QRY="SELECT VL_CODE,VL_MNAME,VL_TALUKA,VL_SECTION,CREATED_DT,MODIFIED_DT FROM NIS.VLGMAST ORDER BY VLGMAST.VL_CODE ASC"

SVRMAST_QRY="SELECT SR_CODE,SR_MNAME,SR_VILLAGE,CREATED_DT,MODIFIED_DT FROM NIS.SVRMAST ORDER BY SVRMAST.SR_CODE ASC"	

CANETMAST_QRY="SELECT CT_CODE,CT_MNAME,CREATED_DT,MODIFIED_DT FROM NIS.CANETMAST ORDER BY CANETMAST.CT_CODE ASC" 				

CANEDTMAST_QRY="SELECT CDT_CODE,CDT_MNAME,CREATED_DT,MODIFIED_DT FROM NIS.CANEDTMAST ORDER BY CANEDTMAST.CDT_CODE ASC"

CANEVMAST_QRY="SELECT CV_CODE,CV_NAME,CREATED_DT,MODIFIED_DT FROM NIS.CANEVMAST ORDER BY CANEVMAST.CV_CODE ASC" 

IRRSRCMAST_QRY="SELECT IS_CODE,IS_MNAME,CREATED_DT,MODIFIED_DT FROM NIS.IRRSRCMAST ORDER BY IRRSRCMAST.IS_CODE ASC" 		

IRRMTDMAST_QRY="SELECT IM_CODE,IM_MNAME,CREATED_DT,MODIFIED_DT FROM NIS.IRRMTDMAST ORDER BY IRRMTDMAST.IM_CODE ASC" 

PLNTMMAST_QRY="SELECT PM_CODE,PM_MNAME,CREATED_DT,MODIFIED_DT FROM NIS.PLNTMMAST ORDER BY PLNTMMAST.PM_CODE ASC"	

JOBTMAST_QRY="SELECT JT_CODE,JT_MNAME,JT_CTYPE,CREATED_DT,MODIFIED_DT FROM NIS.JOBTMAST ORDER BY JOBTMAST.JT_CODE ASC" 	

SSEGMAST_QRY="SELECT SSEG_CODE,SSEG_NAME,CREATED_DT,MODIFIED_DT FROM NIS.SSEGMAST ORDER BY SSEGMAST.SSEG_CODE ASC"	

HSPRGMAST_QRY="SELECT HP_SCODE,HP_SRNO,HP_FSEQ,HP_CTYPE,HP_CVAR,HP_SEC,HP_PLUPDT,HP_RMRK,HP_STAT,HP_STATBY,HP_STATON,CREATED_DT,
MODIFIED_DT FROM NIS.HSPRGMAST ORDER BY HSPRGMAST.HP_SRNO ASC"		

VHLTMAST_QRY="SELECT VT_CODE,VT_NAME,VT_MNAME,VT_MLOAD,VT_ILIMIT,VT_SMSR,CREATED_DT,MODIFIED_DT,VT_DSIT,VT_DSF,VT_DSQ,VT_TNCHR,VT_MILLASGN,VT_DISTANCE,VT_HRSCTRL,VT_HRSCTRLNT,VT_2NDJOINT FROM NIS.VHLTMAST ORDER BY VHLTMAST.VT_CODE ASC"

GADIMAST_QRY="SELECT GD_CODE,GD_SCODE,GD_NAME,GD_MNAME,GD_SEQ,GD_GNO1,GD_GNO2,GD_RENT,GD_RTYPE,CREATED_DT,MODIFIED_DT,GD_ACTIVE 
FROM NIS.GADIMAST ORDER BY GADIMAST.GD_CODE ASC"

V_VEHICLE_JOINT_QRY="SELECT JOINT_CODE,JOINT_NAME,JOINT_MNAME,SORT_ORD,VT_CODE FROM NIS.V_VEHICLE_JOINT ORDER BY V_VEHICLE_JOINT.JOINT_CODE ASC"

PRTMAST_QRY="SELECT PRT_CODE,PRT_NAME,PRT_MNAME,PRT_SHIVAR,PRT_VILLEGE,PRT_SECTION,PRT_TYPE,PRT_FLAG,CREATED_DT,MODIFIED_DT 
FROM NIS.PRTMAST WHERE PRT_TYPE IN ('F','R')  
AND NVL(PRT_FLAG,'N') <> 'Y' 
and exists (select 1 from nis.vlgmast vl where vl.comp_code = prtmast.comp_code and vl.vl_code = prtmast.prt_villege) ORDER BY PRTMAST.PRT_CODE ASC" 

SSNMAST_QRY="SELECT 
TO_CHAR(SN_PLSTDT, 'DD/MM/YYYY') SN_FYSTDT, TO_CHAR(SN_PLENDT, 'DD/MM/YYYY')  SN_FYENDT
FROM NIS.SSNMAST WHERE COMP_CODE='DS' AND SN_CODE='2018-19'
ORDER BY SN_CODE DESC"

CANEQMAST_QRY="SELECT CQ_CODE,CQ_NAME,CQ_MNAME,CREATED_DT,MODIFIED_DT FROM NIS.CANEQMAST ORDER BY CANEQMAST.CQ_CODE ASC"

SERIESHS_SSEGMAST_QRY="SELECT SSEG_CODE,SSEG_NAME,CREATED_DT,MODIFIED_DT 
FROM NIS.SSEGMAST
WHERE DOC_CODE='HS' 
ORDER BY SSEGMAST.SSEG_CODE ASC"


BACK_QRY="SELECT JOINT_CODE,JOINT_MNAME,JOINT_NAME,VT_CODE 
FROM NIS.V_VEHICLE_JOINT 
ORDER BY JOINT_CODE"

FACTORY_DATA_QRY="SELECT PRT_CODE, PRT_NAME,CREATED_DT,MODIFIED_DT 
FROM NIS.PRTMAST WHERE COMP_CODE ='DS' AND PRT_TYPE='S' AND DOC_CODE ='SUPP' 
AND NVL(PRT_FLAG,'N') <> 'Y'"


[Q002]

SECMAST="SELECT SC_CODE,SC_NAME,SC_DIVISION,CREATED_DT,MODIFIED_DT 
FROM NIS.SECMAST 
WHERE TO_CHAR(CREATED_DT, 'YYYYMMDD') >= TO_CHAR(TO_DATE(':PSYNC_DATE','DD/MM/YYYY'),'YYYYMMDD')
OR TO_CHAR(MODIFIED_DT, 'YYYYMMDD') >= TO_CHAR(TO_DATE(':PSYNC_DATE','DD/MM/YYYY'),'YYYYMMDD')
ORDER BY SECMAST.SC_CODE ASC"

VLGMAST="SELECT VL_CODE,VL_MNAME,VL_TALUKA,VL_SECTION,CREATED_DT,MODIFIED_DT FROM NIS.VLGMAST 
WHERE TO_CHAR(CREATED_DT, 'YYYYMMDD') >= TO_CHAR(TO_DATE(':PSYNC_DATE','DD/MM/YYYY'),'YYYYMMDD')
OR TO_CHAR(MODIFIED_DT, 'YYYYMMDD') >= TO_CHAR(TO_DATE(':PSYNC_DATE','DD/MM/YYYY'),'YYYYMMDD')
ORDER BY VLGMAST.VL_CODE ASC"

BACK_DATA="SELECT JOINT_CODE,JOINT_MNAME,JOINT_NAME,VT_CODE 
FROM NIS.V_VEHICLE_JOINT ORDER BY JOINT_CODE"

CANEDTMAST="SELECT CDT_CODE,CDT_MNAME,CREATED_DT,MODIFIED_DT FROM 
NIS.CANEDTMAST 
WHERE TO_CHAR(CREATED_DT, 'YYYYMMDD') >= TO_CHAR(TO_DATE(':PSYNC_DATE','DD/MM/YYYY'),'YYYYMMDD')
OR TO_CHAR(MODIFIED_DT, 'YYYYMMDD') >= TO_CHAR(TO_DATE(':PSYNC_DATE','DD/MM/YYYY'),'YYYYMMDD')
ORDER BY CANEDTMAST.CDT_CODE ASC"

CANEQMAST="SELECT CQ_CODE,CQ_NAME,CQ_MNAME,CREATED_DT,MODIFIED_DT FROM NIS.CANEQMAST 
WHERE TO_CHAR(CREATED_DT, 'YYYYMMDD') >= TO_CHAR(TO_DATE(':PSYNC_DATE','DD/MM/YYYY'),'YYYYMMDD')
OR TO_CHAR(MODIFIED_DT, 'YYYYMMDD') >= TO_CHAR(TO_DATE(':PSYNC_DATE','DD/MM/YYYY'),'YYYYMMDD')
ORDER BY CANEQMAST.CQ_CODE ASC"

CANETMAST="SELECT CT_CODE,CT_MNAME,CREATED_DT,MODIFIED_DT FROM NIS.CANETMAST
WHERE TO_CHAR(CREATED_DT, 'YYYYMMDD') >= TO_CHAR(TO_DATE(':PSYNC_DATE','DD/MM/YYYY'),'YYYYMMDD')
OR TO_CHAR(MODIFIED_DT, 'YYYYMMDD') >= TO_CHAR(TO_DATE(':PSYNC_DATE','DD/MM/YYYY'),'YYYYMMDD') 
ORDER BY CANETMAST.CT_CODE ASC"

CANEVMAST="SELECT CV_CODE,CV_NAME,CREATED_DT,MODIFIED_DT FROM NIS.CANEVMAST 
WHERE TO_CHAR(CREATED_DT, 'YYYYMMDD') >= TO_CHAR(TO_DATE(':PSYNC_DATE','DD/MM/YYYY'),'YYYYMMDD')
OR TO_CHAR(MODIFIED_DT, 'YYYYMMDD') >= TO_CHAR(TO_DATE(':PSYNC_DATE','DD/MM/YYYY'),'YYYYMMDD')
ORDER BY CANEVMAST.CV_CODE ASC"

GADIMAST="SELECT GD_CODE,GD_SCODE,GD_NAME,GD_MNAME,GD_SEQ,GD_GNO1,GD_GNO2,GD_RENT,GD_RTYPE,CREATED_DT,MODIFIED_DT,GD_ACTIVE 
FROM NIS.GADIMAST 
WHERE TO_CHAR(CREATED_DT, 'YYYYMMDD') >= TO_CHAR(TO_DATE(':PSYNC_DATE','DD/MM/YYYY'),'YYYYMMDD')
OR TO_CHAR(MODIFIED_DT, 'YYYYMMDD') >= TO_CHAR(TO_DATE(':PSYNC_DATE','DD/MM/YYYY'),'YYYYMMDD')
ORDER BY GADIMAST.GD_CODE ASC"

HSPRGMAST="SELECT HP_SCODE,HP_SRNO,HP_FSEQ,HP_CTYPE,HP_CVAR,HP_SEC,HP_PLUPDT,HP_RMRK,HP_STAT,HP_STATBY,HP_STATON,CREATED_DT,
MODIFIED_DT FROM NIS.HSPRGMAST 
WHERE TO_CHAR(CREATED_DT, 'YYYYMMDD') >= TO_CHAR(TO_DATE(':PSYNC_DATE','DD/MM/YYYY'),'YYYYMMDD')
OR TO_CHAR(MODIFIED_DT, 'YYYYMMDD') >= TO_CHAR(TO_DATE(':PSYNC_DATE','DD/MM/YYYY'),'YYYYMMDD')
ORDER BY HSPRGMAST.HP_SRNO ASC"

IRRMTDMAST="SELECT IM_CODE,IM_MNAME,CREATED_DT,MODIFIED_DT FROM NIS.IRRMTDMAST 
WHERE TO_CHAR(CREATED_DT, 'YYYYMMDD') >= TO_CHAR(TO_DATE(':PSYNC_DATE','DD/MM/YYYY'),'YYYYMMDD')
OR TO_CHAR(MODIFIED_DT, 'YYYYMMDD') >= TO_CHAR(TO_DATE(':PSYNC_DATE','DD/MM/YYYY'),'YYYYMMDD')
ORDER BY IRRMTDMAST.IM_CODE ASC"

IRRSRCMAST="SELECT IS_CODE,IS_MNAME,CREATED_DT,MODIFIED_DT FROM NIS.IRRSRCMAST 
WHERE TO_CHAR(CREATED_DT, 'YYYYMMDD') >= TO_CHAR(TO_DATE(':PSYNC_DATE','DD/MM/YYYY'),'YYYYMMDD')
OR TO_CHAR(MODIFIED_DT, 'YYYYMMDD') >= TO_CHAR(TO_DATE(':PSYNC_DATE','DD/MM/YYYY'),'YYYYMMDD')
ORDER BY IRRSRCMAST.IS_CODE ASC"

JOBTMAST="SELECT JT_CODE,JT_MNAME,JT_CTYPE,CREATED_DT,MODIFIED_DT FROM NIS.JOBTMAST 
WHERE TO_CHAR(CREATED_DT, 'YYYYMMDD') >= TO_CHAR(TO_DATE(':PSYNC_DATE','DD/MM/YYYY'),'YYYYMMDD')
OR TO_CHAR(MODIFIED_DT, 'YYYYMMDD') >= TO_CHAR(TO_DATE(':PSYNC_DATE','DD/MM/YYYY'),'YYYYMMDD')
ORDER BY JOBTMAST.JT_CODE ASC"

PLNTMMAST="SELECT PM_CODE,PM_MNAME,CREATED_DT,MODIFIED_DT FROM NIS.PLNTMMAST 
WHERE TO_CHAR(CREATED_DT, 'YYYYMMDD') >= TO_CHAR(TO_DATE(':PSYNC_DATE','DD/MM/YYYY'),'YYYYMMDD')
OR TO_CHAR(MODIFIED_DT, 'YYYYMMDD') >= TO_CHAR(TO_DATE(':PSYNC_DATE','DD/MM/YYYY'),'YYYYMMDD')
ORDER BY PLNTMMAST.PM_CODE ASC"

PRTMAST="SELECT PRT_CODE,PRT_NAME,PRT_MNAME,PRT_SHIVAR,PRT_VILLEGE,PRT_SECTION,PRT_TYPE,PRT_FLAG,CREATED_DT,MODIFIED_DT 
FROM NIS.PRTMAST 
WHERE TO_CHAR(CREATED_DT, 'YYYYMMDD') >= TO_CHAR(TO_DATE(':PSYNC_DATE','DD/MM/YYYY'),'YYYYMMDD')
OR TO_CHAR(MODIFIED_DT, 'YYYYMMDD') >= TO_CHAR(TO_DATE(':PSYNC_DATE','DD/MM/YYYY'),'YYYYMMDD')
AND PRT_TYPE IN ('F','R')  
AND NVL(PRT_FLAG,'N') <> 'Y' 
AND EXISTS (SELECT 1 FROM NIS.VLGMAST VL WHERE VL.COMP_CODE = PRTMAST.COMP_CODE AND VL.VL_CODE = PRTMAST.PRT_VILLEGE) ORDER BY PRTMAST.PRT_CODE ASC"


SERIESHS_SSEGMAST="SELECT SSEG_CODE,SSEG_NAME,CREATED_DT,MODIFIED_DT 
FROM NIS.SSEGMAST
WHERE DOC_CODE='HS' 
ORDER BY SSEGMAST.SSEG_CODE ASC"

SSEGMAST="SELECT SSEG_CODE,SSEG_NAME,CREATED_DT,MODIFIED_DT FROM NIS.SSEGMAST 
WHERE TO_CHAR(CREATED_DT, 'YYYYMMDD') >= TO_CHAR(TO_DATE(':PSYNC_DATE','DD/MM/YYYY'),'YYYYMMDD')
OR TO_CHAR(MODIFIED_DT, 'YYYYMMDD') >= TO_CHAR(TO_DATE(':PSYNC_DATE','DD/MM/YYYY'),'YYYYMMDD')
ORDER BY SSEGMAST.SSEG_CODE ASC"

SSNMAST="SELECT TO_CHAR(SN_PLSTDT, 'DD/MM/YYYY') SN_FYSTDT, TO_CHAR(SN_PLENDT, 'DD/MM/YYYY')  SN_FYENDT
FROM NIS.SSNMAST 
WHERE TO_CHAR(CREATED_DT, 'YYYYMMDD') >= TO_CHAR(TO_DATE(':PSYNC_DATE','DD/MM/YYYY'),'YYYYMMDD')
OR TO_CHAR(MODIFIED_DT, 'YYYYMMDD') >= TO_CHAR(TO_DATE(':PSYNC_DATE','DD/MM/YYYY'),'YYYYMMDD')
AND COMP_CODE='DS' 
AND SN_CODE='2018-19'
ORDER BY SN_CODE DESC"

SVRMAST="SELECT SR_CODE,SR_MNAME,SR_VILLAGE,CREATED_DT,MODIFIED_DT FROM NIS.SVRMAST 
WHERE TO_CHAR(CREATED_DT, 'YYYYMMDD') >= TO_CHAR(TO_DATE(':PSYNC_DATE','DD/MM/YYYY'),'YYYYMMDD')
OR TO_CHAR(MODIFIED_DT, 'YYYYMMDD') >= TO_CHAR(TO_DATE(':PSYNC_DATE','DD/MM/YYYY'),'YYYYMMDD')
ORDER BY SVRMAST.SR_CODE ASC"

VHLTMAST="SELECT VT_CODE,VT_NAME,VT_MNAME,VT_MLOAD,VT_ILIMIT,VT_SMSR,CREATED_DT,MODIFIED_DT,VT_DSIT,VT_DSF,VT_DSQ,VT_TNCHR,VT_MILLASGN,VT_DISTANCE,VT_HRSCTRL,VT_HRSCTRLNT,VT_2NDJOINT FROM NIS.VHLTMAST 
WHERE TO_CHAR(CREATED_DT, 'YYYYMMDD') >= TO_CHAR(TO_DATE(':PSYNC_DATE','DD/MM/YYYY'),'YYYYMMDD')
OR TO_CHAR(MODIFIED_DT, 'YYYYMMDD') >= TO_CHAR(TO_DATE(':PSYNC_DATE','DD/MM/YYYY'),'YYYYMMDD')
ORDER BY VHLTMAST.VT_CODE ASC"

V_VEHICLE_JOINT="SELECT JOINT_CODE,JOINT_NAME,JOINT_MNAME,SORT_ORD,VT_CODE FROM NIS.V_VEHICLE_JOINT 
ORDER BY V_VEHICLE_JOINT.JOINT_CODE ASC"

FACTORY_DATA="SELECT PRT_CODE, PRT_NAME,CREATED_DT,MODIFIED_DT 
FROM NIS.PRTMAST 
WHERE TO_CHAR(CREATED_DT, 'YYYYMMDD') >= TO_CHAR(TO_DATE(':PSYNC_DATE','DD/MM/YYYY'),'YYYYMMDD')
OR TO_CHAR(MODIFIED_DT, 'YYYYMMDD') >= TO_CHAR(TO_DATE(':PSYNC_DATE','DD/MM/YYYY'),'YYYYMMDD') 
AND COMP_CODE ='DS' AND PRT_TYPE='S' AND DOC_CODE ='SUPP' 
AND NVL(PRT_FLAG,'N') <> 'Y'"

FIELDREG="SELECT MM.TXN_SEQ,MM.TXN_DOC,MM.COMP_CODE,MM.PLOC_CODE,MM.SSEG_CODE,MM.PERD_CODE,MM.TXN_SEASON,MM.TXN_DIVN,MM.TXN_SRNO,
MM.TXN_FORMNO,MM.TXN_ACCD,TO_CHAR(MM.TXN_DATE1,'DD/MM/YYYY')TXN_DATE1, TO_CHAR(MM.TXN_DATE,'DD/MM/YYYY') TXN_DATE,
MM.TXN_REF2,MM.TXN_CTYPE,MM.TXN_REF1,MM.TXN_CVAR,MM.TXN_IRRSRC,MM.TXN_IRRMTD,MM.TXN_PLNTM,MM.TXN_SHIVAR,
TO_CHAR(MM.TXN_CAREA,'9990.00')TXN_CAREA,MM.TXN_HTYPE,MM.TXN_RMRK, MM.TXN_NINFO,TXN_SINFO,TXN_WINFO,TXN_EINFO
,MM.CREATED_BY,MM.CREATED_DT,MM.MODIFIED_BY,MM.MODIFIED_DT,PM.PRT_NAME,MM.TXN_BNKBR,MM.TXN_CNAME,MM.TXN_ACNO, 
BN.BR_NAME,PM.PRT_MNAME,B.VL_NAME,B.VL_MNAME, PL.PLOC_NAME,DV.DIV_DESC, SS.SSEG_NAME, NULL HRV_TYPE,NULL TXN_TTYPE,NULL TRANS_TYPE,
NULL TXN_VHNO,CQ_CODE,CQ_NAME,TXN_VTYPE 
FROM NIS.MMMMAST MM,NIS.PRTMAST PM, NIS.BRANCHMAST BN, NIS.SVRMAST SR, NIS.VLGMAST B, NIS.PLOCMAST PL, NIS.DIVMAST DV, NIS.SSEGMAST SS,NIS.CANEQMAST CQ 
WHERE MM.TXN_SEASON ='2018-19' 
AND MM.COMP_CODE = PM.COMP_CODE
AND MM.TXN_ACCD = PM.PRT_CODE
AND PM.COMP_CODE = BN.COMP_CODE(+) 
AND PM.PRT_BANKBR = BN.BR_CODE(+) 
AND MM.COMP_CODE = SR.COMP_CODE
AND MM.TXN_SHIVAR = SR.SR_CODE
AND SR.COMP_CODE = B.COMP_CODE
AND SR.SR_VILLAGE = B.VL_CODE 
AND MM.COMP_CODE = PL.COMP_CODE 
AND MM.PLOC_CODE = PL.PLOC_CODE 
AND MM.COMP_CODE = DV.COMP_CODE 
AND MM.TXN_DIVN = DV.DIV_CODE 
AND MM.COMP_CODE = SS.COMP_CODE 
AND MM.SSEG_CODE = SS.SSEG_CODE
AND MM.COMP_CODE = CQ.COMP_CODE(+)
AND MM.TXN_CANEQ = CQ.CQ_CODE(+)
AND MM.TXN_DOC IN ('FREG') 
AND INSTR(MM.POSTED_BY, '---') = 0
UNION ALL
SELECT MM.TXN_SEQ,MM.TXN_DOC,MM.COMP_CODE,MM.PLOC_CODE,MM.SSEG_CODE,MM.PERD_CODE,MM.TXN_SEASON,MM.TXN_DIVN,MM.TXN_SRNO,
MM.TXN_FORMNO,MM.TXN_ACCD,TO_CHAR(MM.TXN_DATE1,'DD/MM/YYYY')TXN_DATE1, TO_CHAR(MM.TXN_DATE,'DD/MM/YYYY') TXN_DATE,
MM.TXN_REF2,MM.TXN_CTYPE,MM.TXN_REF1,MM.TXN_CVAR,MM.TXN_IRRSRC,MM.TXN_IRRMTD,MM.TXN_PLNTM,MM.TXN_SHIVAR,
TO_CHAR(MM.TXN_CAREA,'9990.00')TXN_CAREA,MM.TXN_HTYPE,MM.TXN_RMRK, MM.TXN_NINFO,TXN_SINFO,TXN_WINFO,TXN_EINFO
,MM.CREATED_BY,MM.CREATED_DT,MM.MODIFIED_BY,MM.MODIFIED_DT,PM.PRT_NAME,MM.TXN_BNKBR,MM.TXN_CNAME,MM.TXN_ACNO, 
BN.BR_NAME,PM.PRT_MNAME,null VL_NAME, null VL_MNAME, PL.PLOC_NAME,DV.DIV_DESC, SS.SSEG_NAME,J.JT_NAME HRV_TYPE,MM.TXN_TTYPE,JT.JT_NAME TRANS_TYPE,TXN_VHNO,
null CQ_CODE,null CQ_NAME,TXN_VTYPE
FROM NIS.MMMMAST MM,NIS.PRTMAST PM, NIS.BRANCHMAST BN, NIS.PLOCMAST PL, NIS.DIVMAST DV, NIS.SSEGMAST SS,NIS.JOBTMAST JT,NIS.JOBTMAST J, NIS.SECMAST SC 
WHERE MM.TXN_ACCD = PM.PRT_CODE 
and MM.TXN_SEASON ='2018-19' 
AND MM.COMP_CODE = PM.COMP_CODE
AND MM.TXN_ACCD = PM.PRT_CODE 
AND PM.COMP_CODE = BN.COMP_CODE(+)
AND PM.PRT_BANKBR = BN.BR_CODE(+) 
AND MM.COMP_CODE = PL.COMP_CODE 
AND MM.PLOC_CODE = PL.PLOC_CODE 
AND MM.COMP_CODE = DV.COMP_CODE 
AND MM.TXN_DIVN = DV.DIV_CODE 
AND MM.COMP_CODE = SS.COMP_CODE 
AND MM.SSEG_CODE = SS.SSEG_CODE
AND MM.COMP_CODE = JT.COMP_CODE
AND MM.TXN_TTYPE = JT.JT_CODE
AND MM.COMP_CODE = J.COMP_CODE
AND MM.TXN_HTYPE = J.JT_CODE 
AND MM.COMP_CODE = SC.COMP_CODE(+)
AND MM.TXN_SECTION = SC.SC_CODE(+)
AND MM.TXN_DOC IN ('CET') 
AND INSTR(MM.POSTED_BY, '---') = 0
ORDER BY TXN_DOC, CREATED_DT DESC"


[Q001]

HS_DELETED_QRY="SELECT '3556490858999091539259082' TXN_IMEIREF FROM NIS.DUAL 
union all
SELECT '3556490858999091539259052' TXN_IMEIREF FROM NIS.DUAL
union all
SELECT '3556490858999091539249358' TXN_IMEIREF FROM NIS.DUAL"

HS_DELETED_QRY_OLD="SELECT HS.TXN_IMEIREF FROM NIS.MMMMAST HS 
WHERE HS.TXN_DOC='HS' 
AND HS.TXN_SEASON='2018-19'
AND HS.COMP_CODE='DS'
AND EXISTS(SELECT 1 FROM NIS.MMMMAST WS WHERE WS.TXN_DOC='WS' AND WS.TXN_REFSEQ=HS.TXN_SEQ AND WS.TXN_SEASON=HS.TXN_SEASON
            AND WS.COMP_CODE=HS.COMP_CODE)"


FIELDREQ_QRY_OLD="SELECT MM.TXN_SEQ,MM.TXN_DOC,MM.COMP_CODE,MM.PLOC_CODE,MM.SSEG_CODE,MM.PERD_CODE,MM.TXN_SEASON,MM.TXN_DIVN,MM.TXN_SRNO,
MM.TXN_FORMNO,MM.TXN_ACCD,TO_CHAR(MM.TXN_DATE1,'DD/MM/YYYY')TXN_DATE1, TO_CHAR(MM.TXN_DATE,'DD/MM/YYYY') TXN_DATE,
MM.TXN_REF2,MM.TXN_CTYPE,MM.TXN_REF1,MM.TXN_CVAR,MM.TXN_IRRSRC,MM.TXN_IRRMTD,MM.TXN_PLNTM,MM.TXN_SHIVAR,
TO_CHAR(MM.TXN_CAREA,'9990.00')TXN_CAREA,MM.TXN_HTYPE,MM.TXN_RMRK, MM.TXN_NINFO,TXN_SINFO,TXN_WINFO,TXN_EINFO
,MM.CREATED_BY,MM.CREATED_DT,MM.MODIFIED_BY,MM.MODIFIED_DT,PM.PRT_NAME,MM.TXN_BNKBR,MM.TXN_CNAME,MM.TXN_ACNO, 
BN.BR_NAME,PM.PRT_MNAME,B.VL_NAME,B.VL_MNAME, PL.PLOC_NAME,DV.DIV_DESC, SS.SSEG_NAME,J.JT_NAME HRV_TYPE,MM.TXN_TTYPE,JT.JT_NAME TRANS_TYPE,TXN_VHNO,CQ_CODE,CQ_NAME,TXN_VTYPE 
FROM NIS.MMMMAST MM,NIS.PRTMAST PM, NIS.BRANCHMAST BN, NIS.VLGMAST B, NIS.PLOCMAST PL, NIS.DIVMAST DV, NIS.SSEGMAST SS,NIS.JOBTMAST JT,NIS.JOBTMAST J,NIS.CANEQMAST CQ 
WHERE MM.TXN_ACCD = PM.PRT_CODE 
and MM.TXN_SEASON ='2018-19' 
AND MM.COMP_CODE = PM.COMP_CODE 
AND MM.TXN_BNKBR = BN.BR_CODE(+) 
AND PM.COMP_CODE = B.COMP_CODE
AND PM.PRT_VILLEGE = B.VL_CODE 
AND MM.COMP_CODE = PL.COMP_CODE 
AND MM.PLOC_CODE = PL.PLOC_CODE 
AND MM.COMP_CODE = DV.COMP_CODE 
AND MM.TXN_DIVN = DV.DIV_CODE 
AND MM.COMP_CODE = SS.COMP_CODE 
AND MM.SSEG_CODE = SS.SSEG_CODE
AND MM.COMP_CODE = J.COMP_CODE(+)
AND MM.TXN_HTYPE = J.JT_CODE(+) 
AND MM.COMP_CODE = JT.COMP_CODE(+)
AND MM.TXN_TTYPE = JT.JT_CODE(+)
AND MM.COMP_CODE = CQ.COMP_CODE(+)
AND MM.TXN_CANEQ = CQ.CQ_CODE(+)
AND MM.TXN_DOC IN ('CET','FREG') 
ORDER BY CREATED_DT DESC"


GET_SEQ="SELECT NIS.SEQ_MM.NEXTVAL NEXT_TXNSEQ FROM NIS.DUAL"

INSERT_FREGTRAN="BEGIN
    INSERT INTO NIS.MMMMAST(TXN_SEQ,TXN_DIVN,TXN_DOC,COMP_CODE,PLOC_CODE,SSEG_CODE,PERD_CODE,TXN_SEASON,TXN_SRNO,TXN_FORMNO,TXN_ACCD,TXN_DATE1,
    TXN_DATE,TXN_REF2,TXN_CTYPE,TXN_REF1,TXN_CVAR,TXN_IRRSRC,TXN_IRRMTD,TXN_PLNTM,TXN_SHIVAR,TXN_CAREA,TXN_HTYPE,TXN_RMRK,TXN_NINFO,
    TXN_SINFO,TXN_EINFO,TXN_WINFO, CREATED_BY, CREATED_DT,MODIFIED_DT,TXN_IMEIREF)
    VALUES(':PTXN_SEQ','SUGR','FREG','DS','DUND','FR01',':PPERD_CODE','2018-19',':PTXN_SEQ',':PTXN_FORMNO',
    ':PTXN_ACCD',TO_DATE(':PTXN_DATE1', 'DD/MM/YYYY HH:MI:SS AM'),SYSDATE,':PTXN_REF2',':PTXN_CTYPE',':PTXN_REF1',':PTXN_CVAR',':PTXN_IRRSRC',':PTXN_IRRMTD',
    ':PTXN_PLNTM',':PTXN_SHIVAR',':PTXN_CAREA',':PTXN_HTYPE',':PTXN_RMRK',':PTXN_NINFO',':PTXN_SINFO',':PTXN_EINFO',':PTXN_WINFO',USER,SYSDATE,NULL,':PTXN_TSRNO');

    UPDATE NIS.DOCEVENT A SET A.TXN_APBY = USER, A.TXN_APDT = SYSDATE WHERE A.TXN_SEQ = ':PTXN_SEQ';

END;"

INSERT_FREGRESPONSE="SELECT TXN_IMEIREF,TXN_FORMNO,TXN_SEQ,TXN_SRNO FROM NIS.MMMMAST WHERE TXN_SEQ =':PTXN_SEQ' AND TXN_DOC='FREG' AND COMP_CODE='DS'"

INSERT_HARVSLIP="BEGIN
        INSERT INTO NIS.MMMMAST(TXN_SEQ,TXN_REFSEQ,TXN_DIVN,TXN_DOC,COMP_CODE,PLOC_CODE,SSEG_CODE,PERD_CODE,TXN_DATE,TXN_SEASON,TXN_SRNO,TXN_ACCD,TXN_DATE1,TXN_REF2,TXN_CTYPE,TXN_CVAR,TXN_SHIVAR,TXN_VTYPE,TXN_HTYPE,TXN_CONS,TXN_TRNS,TXN_CNAME,TXN_VHNO,TXN_VJOINT,TXN_CANEQ,TXN_FLAG1,TXN_FLAG2,TXN_FLAG3,TXN_STAT,TXN_FACTORY,CREATED_BY, CREATED_DT,MODIFIED_DT,TXN_VJOINT1,TXN_TTYPE,TXN_WREFSEQ,TXN_EREFSEQ,TXN_IMEIREF)
        VALUES(':PTXN_SEQ',':PTXN_REFSEQ','SUGR','HS','DS','DUND',':PSSEG_CODE',':PPERD_CODE',TO_DATE(':PTXN_DATE', 'DD/MM/YYYY HH:MI:SS AM'),'2018-19',':PTXN_SEQ',':PTXN_ACCD',
        TO_DATE(':PLDATE', 'DD/MM/YYYY HH:MI:SS AM'),':PTXN_REF2',':PTXN_CTYPE',':PTXN_CVAR',':PTXN_SHIVAR',':PTXN_VTYPE',':PTXN_HTYPE',':PTXN_CONS',':PTXN_TRNS',':PTXN_CNAME',':PTXN_VHNO',':PTXN_VJOINT',':PTXN_CANEQ','N',':PTXN_FLAG2',':PTXN_FLAG3','O',':PTXN_FACTORY',USER,SYSDATE,NULL,':PTXN_VJOINT',':PTXN_TTYPE',':PTXN_WREFSEQ',':PTXN_EREFSEQ',':PTXN_GUID');

        DELETE FROM NIS.MMMREF WHERE TXD_SEQ = ':PTXN_SEQ';

        INSERT INTO NIS.MMMREF(TXD_SEQ,TXD_RUNO,TXD_REFDOC,TXD_REFSEQ)VALUES(':PTXN_SEQ', '1', 'FREG', ':PTXN_REFSEQ');

        INSERT INTO NIS.MMMREF(TXD_SEQ,TXD_RUNO,TXD_REFDOC,TXD_REFSEQ)VALUES(':PTXN_SEQ', '2', 'CET', ':PTXN_WREFSEQ');

        INSERT INTO NIS.MMMREF(TXD_SEQ,TXD_RUNO,TXD_REFDOC,TXD_REFSEQ)VALUES(':PTXN_SEQ', '3', 'CET', ':PTXN_EREFSEQ');

        UPDATE NIS.DOCEVENT A SET A.TXN_APBY = USER, A.TXN_APDT = SYSDATE WHERE A.TXN_SEQ = ':PTXN_SEQ';
    END;"

INSERT_HARVSLIPRESPONSE="SELECT TXN_REF2,TXN_SEQ FROM NIS.MMMMAST WHERE TXN_SEQ =':PTXN_SEQ' AND TXN_DOC='HS' AND COMP_CODE='DS'"





